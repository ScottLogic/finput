!function(a){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=a();else if("function"==typeof define&&define.amd)define([],a);else{var b;b="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,b.Finput=a()}}(function(){return function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){c=b.exports=function(a){if(a&&"object"==typeof a){var b=a.which||a.keyCode||a.charCode;b&&(a=b)}if("number"==typeof a)return g[a];var c=String(a),f=d[c.toLowerCase()];if(f)return f;var f=e[c.toLowerCase()];return f?f:1===c.length?c.charCodeAt(0):void 0};var d=c.code=c.codes={backspace:8,tab:9,enter:13,shift:16,ctrl:17,alt:18,"pause/break":19,"caps lock":20,esc:27,space:32,"page up":33,"page down":34,end:35,home:36,left:37,up:38,right:39,down:40,insert:45,"delete":46,command:91,"right click":93,"numpad *":106,"numpad +":107,"numpad -":109,"numpad .":110,"numpad /":111,"num lock":144,"scroll lock":145,"my computer":182,"my calculator":183,";":186,"=":187,",":188,"-":189,".":190,"/":191,"`":192,"[":219,"\\":220,"]":221,"'":222},e=c.aliases={windows:91,"⇧":16,"⌥":18,"⌃":17,"⌘":91,ctl:17,control:17,option:18,pause:19,"break":19,caps:20,"return":13,escape:27,spc:32,pgup:33,pgdn:33,ins:45,del:46,cmd:91};for(f=97;123>f;f++)d[String.fromCharCode(f)]=f-32;for(var f=48;58>f;f++)d[f-48]=f;for(f=1;13>f;f++)d["f"+f]=f+111;for(f=0;10>f;f++)d["numpad "+f]=f+96;var g=c.names=c.title={};for(f in d)g[d[f]]=f;for(var h in e)d[h]=e[h]},{}],2:[function(a,b,c){"use strict";c.ACTION_TYPES={NUMBER:"NUMBER",SHORTCUT:"SHORTCUT",DECIMAL:"DECIMAL",DELIMITER:"DELIMITER",MINUS:"MINUS",UNKNOWN:"UNKNOWN",HORIZONTAL_ARROW:"HORIZONTAL_ARROW",VERTICAL_ARROW:"VERTICAL_ARROW",BACKSPACE:"BACKSPACE",DELETE:"DELETE",UNDO:"UNDO",REDO:"REDO",HOME:"HOME",END:"END"},c.DRAG_STATES={NONE:"NONE",INTERNAL:"INTERNAL",EXTERNAL:"EXTERNAL"}},{}],3:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var f=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}();Object.defineProperty(c,"__esModule",{value:!0});var g=a("keycode"),h=d(g),i=a("./keyHandlers"),j=d(i),k=a("./helpers"),l=d(k),m=a("./valueHistory"),n=d(m),o=a("./constants"),p={format:"0,0.00",maxValue:1e13,minValue:-1e13,maxLength:15,valueStep:1,thousands:",",decimal:".",shortcuts:{k:3,m:6,b:9}},q=function(){function a(b,c){var d=this;e(this,a),this._element=b,this._options=Object.assign(p,c),this._actionTypes=this.createActionTypes(),this._history=new n["default"],this.element.addEventListener("blur",function(a){return d.onFocusout(a)}),this.element.addEventListener("focus",function(a){return d.onFocusin(a)}),this.element.addEventListener("drop",function(a){return d.onDrop(a)}),this.element.addEventListener("paste",function(a){return d.onPaste(a)}),this.element.addEventListener("keydown",function(a){return d.onKeydown(a)}),this.element.addEventListener("keypress",function(a){return d.onKeypress(a)}),this.element.addEventListener("input",function(a){return d.onInput(a)}),document.addEventListener("dragstart",function(a){return d.onDragstart(a)}),document.addEventListener("dragend",function(a){return d.onDragend(a)})}return f(a,[{key:"createActionTypes",value:function(){return[{type:o.ACTION_TYPES.NUMBER,names:["0","1","2","3","4","5","6","7","8","9"]},{type:o.ACTION_TYPES.MINUS,names:["-"]},{type:o.ACTION_TYPES.HOME,names:["home"]},{type:o.ACTION_TYPES.END,names:["end"]},{type:o.ACTION_TYPES.DECIMAL,names:[this.options.decimal]},{type:o.ACTION_TYPES.DELIMITER,names:[this.options.thousands]},{type:o.ACTION_TYPES.SHORTCUT,names:Object.keys(this.options.shortcuts)},{type:o.ACTION_TYPES.BACKSPACE,names:["backspace"]},{type:o.ACTION_TYPES.DELETE,names:["delete"]},{type:o.ACTION_TYPES.HORIZONTAL_ARROW,names:["left","right"]},{type:o.ACTION_TYPES.VERTICAL_ARROW,names:["up","down"]},{type:o.ACTION_TYPES.UNDO,names:["z"],ctrl:!0},{type:o.ACTION_TYPES.REDO,names:["y"],ctrl:!0}]}},{key:"getActionType",value:function(a,b){var c=!0,d=!1,e=void 0;try{for(var f,g=this.actionTypes[Symbol.iterator]();!(c=(f=g.next()).done);c=!0){var h=f.value,i=h.names.indexOf(a),j=i>-1;if(j&&(h.ctrl?b.ctrlKey:!0))return h.type}}catch(k){d=!0,e=k}finally{try{!c&&g["return"]&&g["return"]()}finally{if(d)throw e}}return o.ACTION_TYPES.UNKNOWN}},{key:"setValue",value:function(a){var b=l["default"].fullFormat(a,this.options);this.element.value=b,this.history.addValue(b)}},{key:"onFocusout",value:function(a){console.debug("Focus OUT event",a),this.setValue(this.element.value)}},{key:"onFocusin",value:function(a){console.debug("Focus IN event",a),this.element.selectionStart=0,this.element.selectionEnd=this.element.value.length}},{key:"onDrop",value:function(a){switch(console.debug("Drop event",a),this.dragState){case o.DRAG_STATES.INTERNAL:break;case o.DRAG_STATES.EXTERNAL:this.setValue(a.dataTransfer.getData("text")),a.preventDefault()}}},{key:"onDragstart",value:function(a){this.dragState=a.target===this.element?o.DRAG_STATES.INTERNAL:o.DRAG_STATES.EXTERNAL,console.debug("Drag STARTED",this.dragState,a)}},{key:"onDragend",value:function(a){console.debug("Drag ENDED",this.dragState,a),this.dragState=o.DRAG_STATES.NONE}},{key:"onPaste",value:function(a){console.debug("Paste event",a);var b=a.clipboardData.getData("text"),c=l["default"].editString(this.element.value,b,this.element.selectionStart,this.element.selectionEnd);this.setValue(c),a.preventDefault()}},{key:"onKeypress",value:function(a){console.debug("keypress",a)}},{key:"onKeydown",value:function(a){var b={event:a,code:a.which||a.keyCode,keyName:(0,h["default"])(a)?(0,h["default"])(a).replace("numpad ",""):null,caretStart:this.element.selectionStart,caretEnd:this.element.selectionEnd,currentValue:this.element.value,newValue:this.element.value},c=this.getActionType(b.keyName,a);switch(console.debug(c),c){case o.ACTION_TYPES.NUMBER:j["default"].onNumber(b);break;case o.ACTION_TYPES.DECIMAL:j["default"].onDecimal(b,this.options);break;case o.ACTION_TYPES.MINUS:j["default"].onMinus(b);break;case o.ACTION_TYPES.SHORTCUT:j["default"].onShortcut(b,this.options);break;case o.ACTION_TYPES.HORIZONTAL_ARROW:case o.ACTION_TYPES.HOME:case o.ACTION_TYPES.END:return void console.debug(c);case o.ACTION_TYPES.VERTICAL_ARROW:j["default"].onVerticalArrow(b,this.options.valueStep);break;case o.ACTION_TYPES.BACKSPACE:j["default"].onBackspace(b,this.options.thousands);break;case o.ACTION_TYPES.DELETE:j["default"].onDelete(b,this.options.thousands);break;case o.ACTION_TYPES.UNDO:return void j["default"].onUndo(this,a);case o.ACTION_TYPES.REDO:return void j["default"].onRedo(this,a);default:return void(a.ctrlKey||a.preventDefault())}var d=l["default"].partialFormat(b.newValue,this.options),e=b.newValue;this.element.value=d;var f=l["default"].calculateOffset(e,this.element.value,b.caretStart,this.options),g=b.caretStart+f;this.element.setSelectionRange(g,g),this.history.addValue(d)}},{key:"onInput",value:function(a){console.debug("on INPUT",a),this.setValue(this.element.value)}},{key:"element",get:function(){return this._element}},{key:"options",get:function(){return this._options}},{key:"value",get:function(){return this._value},set:function(a){this._value=a}},{key:"formattedValue",get:function(){return this._formattedValue},set:function(a){this._formattedValue=a}},{key:"actionTypes",get:function(){return this._actionTypes}},{key:"dragState",get:function(){return this._dragState},set:function(a){this._dragState=a}},{key:"history",get:function(){return this._history}}]),a}();c["default"]=q,b.exports=c["default"]},{"./constants":2,"./helpers":4,"./keyHandlers":5,"./valueHistory":6,keycode:1}],4:[function(a,b,c){"use strict";a("./constants");c.editString=function(a,b,c){var d=arguments.length<=3||void 0===arguments[3]?c:arguments[3],e=a.slice(0,c),f=a.slice(d,a.length);return""+e+b+f},c.fullFormat=function(a,b){return a},c.partialFormat=function(a,b){var c=a.replace(new RegExp("["+(b.currency||"")+b.thousands+"]","g"),""),d=c.indexOf(b.decimal)>-1?c.indexOf(b.decimal)-1:c.length-1,e="-"===c[0]?1:0,f=d,g=1;for(g;f>e;f--,g++)g%3===0&&(c=this.editString(c,",",f));return b.currency&&c&&c.match(/\d/)?"-"===c[0]?c.replace("-","-"+b.currency):""+b.currency+c:c},c.calculateOffset=function(a,b,c,d){var e=void 0,f=0,g=0;for(e=0;c>e;e++)(a[e]===d.thousands||d.currency&&a[e]===d.currency)&&f++;for(e=0;c>e;e++)(b[e]===d.thousands||d.currency&&b[e]===d.currency)&&g++;return g-f}},{"./constants":2}],5:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}var e=(a("./constants"),a("./helpers")),f=d(e);b.exports={onNumber:function(a){var b=!("-"===a.currentValue[0]&&0===a.caretStart&&0===a.caretEnd);b&&(a.newValue=f["default"].editString(a.currentValue,a.keyName,a.caretStart,a.caretEnd),a.caretStart+=1),a.event.preventDefault()},onMinus:function(a){var b=0===a.caretStart&&("-"!==a.currentValue[0]||a.caretEnd>0);b&&(a.newValue=f["default"].editString(a.currentValue,"-",a.caretStart,a.caretEnd),a.caretStart+=1),a.event.preventDefault()},onDecimal:function(a,b){var c=a.currentValue.indexOf(b.decimal),d=-1===c||c>=a.caretStart&&c<a.caretEnd;d&&(a.newValue=f["default"].editString(a.currentValue,b.decimal,a.caretStart,a.caretEnd),a.caretStart+=1),a.event.preventDefault()},onShortcut:function(a,b){var c=b.shortcuts[a.keyName.toLowerCase()];c&&(a.caretStart=a.newValue.length),a.event.preventDefault()},onBackspace:function(a,b){var c=void 0,d=void 0;if(a.caretStart===a.caretEnd)if(a.event.ctrlKey)c="",d=a.currentValue.slice(a.caretStart,a.currentValue.length),a.caretStart=0;else{var e=1;e=a.caretStart-e>=0?e:0,c=a.currentValue.slice(0,a.caretStart-e),d=a.currentValue.slice(a.caretStart,a.currentValue.length),a.caretStart+=-e}else c=a.currentValue.slice(0,a.caretStart),d=a.currentValue.slice(a.caretEnd,a.currentValue.length);a.newValue=c+d,a.event.preventDefault()},onDelete:function(a,b){var c=void 0,d=void 0;if(a.caretStart===a.caretEnd){var e=a.currentValue[a.caretStart];if(a.event.ctrlKey)c=a.currentValue.slice(0,a.caretStart),d="";else{var f=e===b;a.caretStart+=f?1:0;var g=a.caretStart+(f?0:1);c=a.currentValue.slice(0,a.caretStart),d=a.currentValue.slice(g,a.currentValue.length)}}else c=a.currentValue.slice(0,a.caretStart),d=a.currentValue.slice(a.caretEnd,a.currentValue.length);a.newValue=c+d,a.event.preventDefault()},onVerticalArrow:function(a,b){if(b&&!isNaN(b)){switch(a.keyName){case"up":break;case"down":}a.event.preventDefault()}},onUndo:function(a,b){a.element.value=a.history.undo(),a.element.setSelectionRange(a.element.value.length,a.element.value.length),b.preventDefault()},onRedo:function(a,b){a.element.value=a.history.redo(),a.element.setSelectionRange(a.element.value.length,a.element.value.length),b.preventDefault()}}},{"./constants":2,"./helpers":4}],6:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var e=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}();Object.defineProperty(c,"__esModule",{value:!0});var f=50,g=function(){function a(){d(this,a),this._history=[null],this._currentIndex=0}return e(a,[{key:"undo",value:function(){return this.currentIndex>0&&this.currentIndex--,this.currentValue}},{key:"redo",value:function(){return this.currentIndex<this.history.length-1&&this.currentIndex++,this.currentValue}},{key:"addValue",value:function(a){return a!==this.currentValue&&(this.history.splice(this.currentIndex+1,null,a),this.history.length>f&&this.history.shift()),this.currentIndex=this.history.length-1,this.currentValue}},{key:"history",get:function(){return this._history},set:function(a){this._history=a}},{key:"currentIndex",get:function(){return this._currentIndex},set:function(a){this._currentIndex=a}},{key:"currentValue",get:function(){return this.history[this.currentIndex]}}]),a}();c["default"]=g,b.exports=c["default"]},{}]},{},[3])(3)});