!function(a){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=a();else if("function"==typeof define&&define.amd)define([],a);else{var b;b="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,b.finput=a()}}(function(){return function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){"use strict";c.ACTION_TYPES={NUMBER:"NUMBER",SHORTCUT:"SHORTCUT",DECIMAL:"DECIMAL",DELIMITER:"DELIMITER",MINUS:"MINUS",UNKNOWN:"UNKNOWN",BACKSPACE:"BACKSPACE",DELETE:"DELETE",UNDO:"UNDO",REDO:"REDO"},c.DRAG_STATES={NONE:"NONE",INTERNAL:"INTERNAL",EXTERNAL:"EXTERNAL"},c.RANGE={ALL:"ALL",POSITIVE:"POSITIVE"}},{}],2:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(c,"__esModule",{value:!0});var f=Object.assign||function(a){for(var b=1;b<arguments.length;b++){var c=arguments[b];for(var d in c)Object.prototype.hasOwnProperty.call(c,d)&&(a[d]=c[d])}return a},g=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}();c["default"]=function(a,b){if(!a)throw"Input element must be supplied as first argument";var c=new p(a,b||{});return a.setRawValue=function(a){return c.setRawValue(a)},a.setValue=function(a){return c.setValue(a)},function(){c.removeListeners(),delete a.setRawValue,delete a.setValue}};var h=a("./keyHandlers"),i=d(h),j=a("./helpers"),k=d(j),l=a("./valueHistory"),m=d(l),n=a("./constants"),o={scale:2,range:n.RANGE.ALL,fixed:!0,thousands:",",decimal:".",shortcuts:{k:1e3,m:1e6,b:1e9},invalidKeyCallback:function(){}},p=function(){function a(b,c){e(this,a),this._element=b,this._options=f({},o,c),this._actionTypes=this.createActionTypes(),this._history=new m["default"],this._listeners={blur:{element:this.element,handler:this.onFocusout.bind(this)},focus:{element:this.element,handler:this.onFocusin.bind(this)},drop:{element:this.element,handler:this.onDrop.bind(this)},paste:{element:this.element,handler:this.onPaste.bind(this)},keydown:{element:this.element,handler:this.onKeydown.bind(this)},input:{element:this.element,handler:this.onInput.bind(this)},dragstart:{element:document,handler:this.onDragstart.bind(this)},dragend:{element:document,handler:this.onDragend.bind(this)}},this.removeListeners();for(var d in this._listeners)this._listeners[d].element.addEventListener(d,this._listeners[d].handler)}return g(a,[{key:"createActionTypes",value:function(){return[{type:n.ACTION_TYPES.NUMBER,names:["0","1","2","3","4","5","6","7","8","9"]},{type:n.ACTION_TYPES.MINUS,names:["-"]},{type:n.ACTION_TYPES.DECIMAL,names:[this.options.decimal]},{type:n.ACTION_TYPES.DELIMITER,names:[this.options.thousands]},{type:n.ACTION_TYPES.SHORTCUT,names:Object.keys(this.options.shortcuts)},{type:n.ACTION_TYPES.BACKSPACE,names:["backspace"]},{type:n.ACTION_TYPES.DELETE,names:["delete"]},{type:n.ACTION_TYPES.UNDO,names:["z"],ctrl:!0},{type:n.ACTION_TYPES.REDO,names:["y"],ctrl:!0}]}},{key:"createInvalidKeyInfo",value:function(a){return{event:a.event,keyName:a.keyName,code:a.code}}},{key:"getActionType",value:function(a,b){var c=!0,d=!1,e=void 0;try{for(var f,g=this._actionTypes[Symbol.iterator]();!(c=(f=g.next()).done);c=!0){var h=f.value,i=h.names.indexOf(a),j=i>-1;if(j&&(!h.ctrl||b.ctrlKey))return h.type}}catch(k){d=!0,e=k}finally{try{!c&&g["return"]&&g["return"]()}finally{if(d)throw e}}return n.ACTION_TYPES.UNKNOWN}},{key:"getRawValue",value:function(){return Number(this.element.value.replace(new RegExp(this.options.thousands,"g"),""))}},{key:"setValue",value:function(a,b){var c=k["default"].fullFormat(a,this.options);b&&!a||(this.element.value=c,this.element.rawValue=this.getRawValue(this.element.value),this._history.addValue(c))}},{key:"setRawValue",value:function(a){var b=void 0;if(a)if("number"!=typeof a||isNaN(a)){if("string"!=typeof a)return;b=a}else b=a.toString();else b="";var c=k["default"].parseString(b,this.options);this.setValue(c,!1)}},{key:"onFocusout",value:function(a){this.setValue(this.element.value)}},{key:"onFocusin",value:function(a){if(this.options.onFocusinCallback){var b=this.options.onFocusinCallback(a);b&&(this.element.selectionStart=b.start,this.element.selectionEnd=b.end)}else this.element.selectionStart=0,this.element.selectionEnd=this.element.value.length}},{key:"onDrop",value:function(a){switch(this._dragState){case n.DRAG_STATES.INTERNAL:break;case n.DRAG_STATES.EXTERNAL:var b=k["default"].parseString(a.dataTransfer.getData("text"),this.options);this.setValue(b,!0),a.preventDefault()}}},{key:"onDragstart",value:function(a){this._dragState=a.target===this.element?n.DRAG_STATES.INTERNAL:n.DRAG_STATES.EXTERNAL}},{key:"onDragend",value:function(a){this._dragState=n.DRAG_STATES.NONE}},{key:"onPaste",value:function(a){var b=k["default"].parseString(a.clipboardData.getData("text"),this.options);this.setValue(b,!0),a.preventDefault()}},{key:"onKeydown",value:function(a){var b={event:a,code:a.which||a.keyCode,keyName:a.key.toLowerCase(),caretStart:this.element.selectionStart,caretEnd:this.element.selectionEnd,currentValue:this.element.value,newValue:this.element.value},c=this.getActionType(b.keyName,a);switch(c){case n.ACTION_TYPES.NUMBER:i["default"].onNumber(b,this.options);break;case n.ACTION_TYPES.DECIMAL:i["default"].onDecimal(b,this.options);break;case n.ACTION_TYPES.MINUS:i["default"].onMinus(b,this.options);break;case n.ACTION_TYPES.SHORTCUT:i["default"].onShortcut(b,this.options);break;case n.ACTION_TYPES.BACKSPACE:i["default"].onBackspace(b,this.options.thousands);break;case n.ACTION_TYPES.DELETE:i["default"].onDelete(b,this.options.thousands);break;case n.ACTION_TYPES.UNDO:return void i["default"].onUndo(this,a);case n.ACTION_TYPES.REDO:return void i["default"].onRedo(this,a);default:return void(1!==a.key.length||a.ctrlKey||(this.options.invalidKeyCallback(this.createInvalidKeyInfo(b)),a.preventDefault()))}var d=k["default"].partialFormat(b.newValue,this.options),e=b.newValue;this.element.value=d,this.element.rawValue=this.getRawValue(this.element.value);var f=k["default"].calculateOffset(e,this.element.value,b.caretStart,this.options),g=b.caretStart+f;this.element.setSelectionRange(g,g),this._history.addValue(d)}},{key:"onInput",value:function(a){this.setValue(this.element.value)}},{key:"removeListeners",value:function(){for(var a in this._listeners)this._listeners[a].element.removeEventListener(a,this._listeners[a].handler)}},{key:"element",get:function(){return this._element}},{key:"options",get:function(){return this._options}}]),a}();b.exports=c["default"]},{"./constants":1,"./helpers":3,"./keyHandlers":4,"./valueHistory":5}],3:[function(a,b,c){"use strict";a("./constants");c.editString=function(a,b,c){var d=arguments.length>3&&void 0!==arguments[3]?arguments[3]:c,e=a.slice(0,c),f=a.slice(d,a.length);return""+e+b+f},c.formatThousands=function(a,b){var c=a.indexOf(b.decimal)>-1?a.indexOf(b.decimal)-1:a.length-1,d="-"===a[0]?1:0,e=c,f=1;for(f;e>d;e--,f++)f%3===0&&(a=this.editString(a,b.thousands,e));return a},c.partialFormat=function(a,b){return a=a.replace(new RegExp("["+b.thousands+"]","g"),""),a=this.removeleadingZeros(a,b),a=this.removeExtraDecimals(a,b),a=this.formatThousands(a,b)},c.fullFormat=function(a,b){if(a=this.partialFormat(a,b),null==a||""==a)return"";var c=a.indexOf(b.decimal)>-1?a.indexOf(b.decimal):a.length,d="-"===a[0]?a[0]:"",e=a.slice(d?1:0,c),f=a.slice(c+1);return b.fixed?b.scale>0?(f=f.length>=b.scale?f.slice(0,b.scale):f+Array(b.scale-f.length+1).join("0"),e.length||(e="0"),""+d+e+b.decimal+f):""+d+e:a},c.removeleadingZeros=function(a,b){for(var c=a.indexOf(b.decimal)>-1?a.indexOf(b.decimal):a.length,d="-"===a[0]?a[0]:"",e=a.slice(d?1:0,c+1),f=a.slice(c+1),g=0;0==e[g]&&e[g+1]!==b.decimal&&e.length>1;)e=e.slice(0,g)+e.slice(g+1);return""+d+e+f},c.removeExtraDecimals=function(a,b){var c=a.indexOf(b.decimal)>-1?a.indexOf(b.decimal):a.length,d=a.slice(0,c+1),e=a.slice(c+1).slice(0,null==b.scale?e.length:b.scale);return""+d+e},c.calculateOffset=function(a,b,c,d){var e=void 0,f=0,g=0;for(e=0;e<c;e++)a[e]===d.thousands&&f++;for(e=0;e<c;e++)b[e]===d.thousands&&g++;return g-f},c.allowedZero=function(a,b,c,d){if(0!=b)return!0;var e=a.indexOf(d.decimal)>-1?a.indexOf(d.decimal):a.length,f="-"===a[0],g=a.slice(f?1:0,e);return c=f?c-1:c,!(g.length>0&&c<g.length+1)||0!=g&&c>0},c.toNumber=function(a,b){return a&&Number(a.replace(new RegExp("["+b.thousands+"]","g"),""))},c.parseString=function(a,b){var c=1,d="",e=!0,f=!1,g=void 0;try{for(var h,i=a[Symbol.iterator]();!(e=(h=i.next()).done);e=!0){var j=h.value;isNaN(j)?j===b.decimal&&d.indexOf(j)===-1?d+=b.decimal:b.shortcuts[j]?c*=b.shortcuts[j]:"-"!==j||d.length||(d=j):d+=j}}catch(k){f=!0,g=k}finally{try{!e&&i["return"]&&i["return"]()}finally{if(f)throw g}}if(!d.length)return"";var l=Number(d.replace(new RegExp("["+b.decimal+"]","g"),".")),m=String(l*c).replace(new RegExp("[.]","g"),b.decimal),n=m.indexOf("e")!==-1;return n?"":m}},{"./constants":1}],4:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}var e=a("./constants"),f=a("./helpers"),g=d(f);b.exports={onNumber:function(a,b){var c=g["default"].editString(a.currentValue,"",a.caretStart,a.caretEnd),d=!("-"===a.currentValue[0]&&0===a.caretStart&&0===a.caretEnd)&&g["default"].allowedZero(c,a.keyName,a.caretStart,b);d&&(a.newValue=g["default"].editString(a.currentValue,a.keyName,a.caretStart,a.caretEnd),a.caretStart+=1),a.event.preventDefault()},onMinus:function(a,b){var c=0===a.caretStart&&("-"!==a.currentValue[0]||a.caretEnd>0)&&b.range!==e.RANGE.POSITIVE;c&&(a.newValue=g["default"].editString(a.currentValue,"-",a.caretStart,a.caretEnd),a.caretStart+=1),a.event.preventDefault()},onDecimal:function(a,b){var c=a.currentValue.indexOf(b.decimal),d=b.scale>0&&(c===-1||c>=a.caretStart&&c<a.caretEnd);d&&(a.newValue=g["default"].editString(a.currentValue,b.decimal,a.caretStart,a.caretEnd),a.caretStart+=1),a.event.preventDefault()},onShortcut:function(a,b){var c=b.shortcuts[a.keyName.toLowerCase()]||1,d=g["default"].editString(a.currentValue,"",a.caretStart,a.caretEnd),e=(g["default"].toNumber(d,b)||1)*c;c&&(e.toString().indexOf("e")===-1&&(a.newValue=String(e)),a.caretStart=a.newValue.length+Math.log10(1e3)),a.event.preventDefault()},onBackspace:function(a,b){var c=void 0,d=void 0;if(a.caretStart===a.caretEnd)if(a.event.ctrlKey)c="",d=a.currentValue.slice(a.caretStart,a.currentValue.length),a.caretStart=0;else{var e=1;e=a.caretStart-e>=0?e:0,c=a.currentValue.slice(0,a.caretStart-e),d=a.currentValue.slice(a.caretStart,a.currentValue.length),a.caretStart+=-e}else c=a.currentValue.slice(0,a.caretStart),d=a.currentValue.slice(a.caretEnd,a.currentValue.length);a.newValue=c+d,a.event.preventDefault()},onDelete:function(a,b){var c=void 0,d=void 0;if(a.caretStart===a.caretEnd){var e=a.currentValue[a.caretStart];if(a.event.ctrlKey)c=a.currentValue.slice(0,a.caretStart),d="";else{var f=e===b;a.caretStart+=f?1:0;var g=a.caretStart+(f?0:1);c=a.currentValue.slice(0,a.caretStart),d=a.currentValue.slice(g,a.currentValue.length)}}else c=a.currentValue.slice(0,a.caretStart),d=a.currentValue.slice(a.caretEnd,a.currentValue.length);a.newValue=c+d,a.event.preventDefault()},onUndo:function(a,b){a.element.value=a._history.undo(),a.element.setSelectionRange(a.element.value.length,a.element.value.length),b.preventDefault()},onRedo:function(a,b){a.element.value=a._history.redo(),a.element.setSelectionRange(a.element.value.length,a.element.value.length),b.preventDefault()}}},{"./constants":1,"./helpers":3}],5:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(c,"__esModule",{value:!0});var e=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),f=50,g=function(){function a(){d(this,a),this._history=[null],this._currentIndex=0}return e(a,[{key:"undo",value:function(){return this.currentIndex>0&&this.currentIndex--,this.currentValue}},{key:"redo",value:function(){return this.currentIndex<this.history.length-1&&this.currentIndex++,this.currentValue}},{key:"addValue",value:function(a){return a!==this.currentValue&&(this.history.splice(this.currentIndex+1,null,a),this.history.length>f&&this.history.shift()),this.currentIndex=this.history.length-1,this.currentValue}},{key:"history",get:function(){return this._history},set:function(a){this._history=a}},{key:"currentIndex",get:function(){return this._currentIndex},set:function(a){this._currentIndex=a}},{key:"currentValue",get:function(){return this.history[this.currentIndex]}}]),a}();c["default"]=g,b.exports=c["default"]},{}]},{},[2])(2)});